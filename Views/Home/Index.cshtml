@model SearchHitCounter.Models.SearchViewModel
@using System
@{
    ViewData["Title"] = "Search";
    var hasResults = Model is not null && Model.Results.Count > 0;
}

<div class="search-shell @(hasResults ? "has-results" : "no-results")">
    <div class="search-card">
        <span class="search-badge">Search hit counter</span>
        <h1 class="search-title">Compare search volume, fast</h1>
        <p class="search-subtitle">
            Enter one or more words to compare total hits across multiple engines. Each word is searched and summed.
        </p>
        <form method="get" class="search-form">
            <input class="search-input" type="text" name="query" placeholder="e.g. hello world" value="" />
            <button class="search-button" type="submit">Search</button>
        </form>
    </div>
    @if (hasResults)
    {
        <div class="results-card">
            <div class="results-header">
                <h2 class="results-title">Results</h2>
                <div class="results-subtitle">Total hits for "<strong>@Model?.Query</strong>"</div>
            </div>
            <div class="results-list">
                @foreach (var result in Model.Results)
                {
                    <div class="result-row">
                        <div class="result-provider">
                            <div class="provider-name">
                                @if (string.Equals(result.Provider, "Google", StringComparison.OrdinalIgnoreCase))
                                {
                                    <span class="provider-icon provider-google" aria-hidden="true">G</span>
                                }
                                else if (string.Equals(result.Provider, "Algolia", StringComparison.OrdinalIgnoreCase))
                                {
                                    <span class="provider-icon provider-algolia" aria-hidden="true">A</span>
                                }
                                @result.Provider
                            </div>
                            @if (!string.IsNullOrWhiteSpace(result.ErrorMessage))
                            {
                                <div class="provider-error">@result.ErrorMessage</div>
                            }
                        </div>
                        <div class="result-hits">
                            @if (string.IsNullOrWhiteSpace(result.ErrorMessage))
                            {
                                <span class="results-value">@result.TotalHits.ToString("N0")</span>
                            }
                            else
                            {
                                <span class="provider-error">Null</span>
                            }
                        </div>
                    </div>
                }
            </div>
        </div>
    }
</div>